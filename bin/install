#!/usr/bin/env node
/* -*- mode: Javascript -*-

bin/metadata â€” this file is part of minipaas.
Copyright 2014 Kuno Woudt <kuno@frob.nl>

This program is licensed under copyleft-next version 0.3.0,
see LICENSE.txt for more information.

*/

var minipaas = require('../');
var argv = require('minimist')(process.argv.slice(2));
var _ = require('underscore');

minipaas.pull(argv['_']).then(function (data) {
    var repotags = _(data).map(function (item, idx) { return item.repotag; });
    console.log('pull done, repotags:', repotags);

    return minipaas.services(repotags);
}).then(function (data) {
    if (data.length) {
        data.forEach(function (elem) {
            elem.printInfo();
        });
        process.exit(0);
    } else {
        console.log("No matches.", data);
        process.exit(1);
    }
}).catch(function (err) {
    console.log(err.toString());
    process.exit(1);
});

